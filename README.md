# חולשה במערכת Mashov – בקשות OTP ו-Rate Limiting חלש

![preview](https://i.ibb.co/RkDbBNkZ/image.png)

## מי אני ולמה אני כותב את זה
אני תלמיד לשעבר שלמד והשתמש במערכת Mashov.  
כבר לפני כמה זמן, כשעוד הייתי בן 17, שמתי לב שיש בעיה במנגנון של שליחת קוד אימות (OTP).

בהתחלה זה היה סתם מתוך סקרנות. אפילו השתמשתי בזה פעם אחת “לכיף” כדי לעשות ספאם לחבר עם הודעות קוד.  
רק אחר כך הבנתי שזו לא סתם שטות, אלא בעיה אמיתית שיכולה לפגוע בפרטיות של תלמידים.

---

## מה הבעיה בקצרה
יש endpoint במערכת ששולח OTP.  
ה-endpoint הזה מוגן דרך Cloudflare, אבל בפועל ה-Rate Limiting שלו מאוד חלש.

זה מאפשר:
- לשלוח הרבה מאוד בקשות בזמן קצר
- לבדוק התאמה בין פרטים שונים
- להסיק מידע לפי התגובות של השרת
- לשלוח הרבה הודעות OTP לאותו מספר (ספאם)

לא צריך פריצה, לא צריך לעקוף התחברות, ולא צריך כלים מיוחדים.

---

## תוכנה שבניתי והיכולות שלה
כדי להבין את הבעיה לעומק, כתבתי תוכנה שבודקת את ההתנהגות של ה-API בקצב גבוה ובצורה שיטתית.

באמצעות החולשה, התוכנה **מסוגלת להסיק** את המידע הבא:

- למצוא **מספר תעודת זהות של תלמיד** אם יודעים את מספר הטלפון שלו או את כתובת המייל (בכמה שעות)
- למצוא **בית ספר של תלמיד** אם יודעים את השם המלא שלו ואת מספר הטלפון או המייל (בפחות מדקה)
- למצוא **מספר טלפון מלא של תלמיד** אם יודעים את השם המלא ואת בית הספר (בכמה שעות)

המידע לא “נשלף” ישירות, אלא מוסק לפי תגובות שונות של המערכת.

---

## מה אפשר לעשות עם זה (לרעה)
אם מישהו רוצה לנצל את זה, הוא יכול:
- לעשות ספאם לטלפונים של תלמידים
- לבדוק אם מספר טלפון שייך לתלמיד במערכת
- לקשר בין שם, בית ספר, טלפון ות״ז
- להטריד אנשים, כולל קטינים

אני לא עשיתי דברים כאלה מעבר לשטות חד-פעמית, אבל ברור שמישהו אחר כן יכול.

---

## למה זה חמור
- מדובר בתלמידים, הרבה מהם קטינים
- גם אם לא “רואים” את המידע ישירות, אפשר להסיק אותו
- זה פוגע בפרטיות
- זה פוגע באמון במערכת
- זה עלול להכניס את המערכת לבעיות משפטיות

---

## למה Cloudflare לא מספיק פה
Cloudflare חוסם דברים גסים, אבל:
- אין הגבלה אמיתית לפי מספר טלפון
- אין הגבלה טובה לפי משתמש
- אין אחידות בתגובות של ה-API
- אפשר לשלוח הרבה בקשות בקצב נמוך יחסית ועדיין להצליח

זו בעיית לוגיקה, לא בעיית “האקר גאון”.

---

## מה לדעתי צריך לתקן
בצורה פשוטה:
- Rate Limiting חזק יותר
- הגבלה לפי טלפון, משתמש ו-IP יחד
- תגובה זהה מהשרת בכל מצב
- חסימה אחרי כמה ניסיונות
- CAPTCHA או משהו דומה לפני שליחת OTP

---

## סיכום
זו לא חולשה מתוחכמת, אבל דווקא בגלל זה היא מסוכנת.  
טיפול קטן יחסית יכול לסגור פה חור גדול.

מקווה שתיקחו את זה ברצינות.
